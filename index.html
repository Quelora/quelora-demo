<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="page_title">Quelora | High-Performance Comment System with Augmented Intelligence</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <link rel="stylesheet" href="style.css">
    
    <script src="https://unpkg.com/i18next@23.12.2/i18next.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="https://avatars.githubusercontent.com/u/224778839?v=4" alt="Quelora Logo" class="me-2 rounded-circle" width="30" height="30">
                <strong style="color: var(--color-text-dark);">Quelora</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="#demo" data-i18n="nav.demo">Demo</a></li>
                    <li class="nav-item"><a class="nav-link" href="#features" data-i18n="nav.features">Features</a></li>
                    <li class="nav-item"><a class="nav-link" href="#architecture" data-i18n="nav.architecture">Architecture</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://github.com/Quelora/quelora-infra#readme" target="_blank" data-i18n="nav.docs">Docs</a></li>
                </ul>
                <div class="d-flex align-items-center">
                    <div class="dropdown me-2">
                        <button class="btn btn-outline-secondary dropdown-toggle d-flex align-items-center" type="button" id="languageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <img src="https://flagcdn.com/w20/us.png" alt="English" id="currentLanguageFlag">
                            <span id="currentLanguage" class="ms-1">EN</span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="languageDropdown">
                            <li><a class="dropdown-item d-flex align-items-center language-option" href="#" data-lang="en"><img src="https://flagcdn.com/w20/us.png" alt="English" class="me-2"> English</a></li>
                            <li><a class="dropdown-item d-flex align-items-center language-option" href="#" data-lang="es"><img src="https://flagcdn.com/w20/es.png" alt="Spanish" class="me-2"> Español</a></li>
                            <li><a class="dropdown-item d-flex align-items-center language-option" href="#" data-lang="fr"><img src="https://flagcdn.com/w20/fr.png" alt="French" class="me-2"> Français</a></li>
                            <li><a class="dropdown-item d-flex align-items-center language-option" href="#" data-lang="de"><img src="https://flagcdn.com/w20/de.png" alt="German" class="me-2"> Deutsch</a></li>
                        </ul>
                    </div>
                    
                    <button class="btn btn-outline-secondary theme-toggle me-2" id="themeToggle">
                        <i class="bi bi-sun-fill theme-icon" id="themeIcon"></i>
                    </button>
                    
                    <a href="#" id="navContactLink" class="btn btn-outline-primary ms-2" data-i18n="footer.contact">Contact</a>
                </div>
            </div>
        </div>
    </nav>

    <section class="hero">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-3" data-i18n="hero.new_title">Quelora. The High-Performance Comment System with Augmented Intelligence.</h1>
            <p class="lead mb-4 text-secondary" data-i18n="hero.new_subtitle">Advanced moderation, geolocation, and analytics powered by AI, natively integrated into your website.</p>
            <div class="d-flex justify-content-center gap-3 flex-wrap pt-2">
                <a href="/news.html" class="btn btn-quelora btn-lg px-5" data-i18n="hero.view_live_demo">View Live Demo</a>
                <a href="#" id="heroContactLink" class="btn btn-outline-secondary btn-lg px-5" data-i18n="footer.contact">Contact</a>
            </div>
        </div>
    </section>

    <section id="demo" class="py-5">
        <div class="container">
            <div class="text-center mb-5">
                <h2 data-i18n="demo.title">See it in Action</h2>
                <p class="lead text-secondary" data-i18n="demo.subtitle">From the multi-tenant control panel to the end-user widget.</p>
            </div>
            <div class="row g-4 align-items-center">
                <div class="col-lg-7">
                    <div class="card p-3">
                        <div class="img-placeholder">
                            
                        </div>
                        <div class="card-body text-center">
                            <h4 data-i18n="demo.dashboard_title">Centralized Dashboard</h4>
                            <p class="text-secondary" data-i18n="demo.dashboard_text">Manage sites, moderate content, view analytics, and configure AI settings from one place.</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5">
                    <div class="card p-3">
                        <div class="img-placeholder">
                            
                        </div>
                        <div class="card-body text-center">
                            <h4 data-i18n="demo.widget_title">Live Comment Widget</h4>
                            <p class="text-secondary" data-i18n="demo.widget_text">The fast, responsive, and feature-rich client that integrates into your site.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="features" class="py-5" style="background-color: var(--color-background-dark) !important;">
        <div class="container">
            <div class="text-center mb-5">
                <h2 data-i18n="features.title">A Complete Engagement Platform</h2>
                <p class="lead text-secondary" data-i18n="features.subtitle">More than just comments. A full suite of tools for your community.</p>
            </div>
            <div class="row g-4">
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 p-4">
                        <div class="icon-box"><i class="bi bi-broadcast"></i></div>
                        <h4 data-i18n="features.live_chat_title">Real-time Live Chat</h4>
                        <p class="text-secondary" data-i18n="features.live_chat_desc">Engage your audience instantly with WebSocket-powered live chat, complete with typing indicators and viewer counts.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 p-4">
                        <div class="icon-box"><i class="bi bi-robot"></i></div>
                        <h4 data-i18n="features.ai_title">AI-Powered Moderation</h4>
                        <p class="text-secondary" data-i18n="features.ai_desc">Automatically analyzes sentiment, summarizes debates, and filters toxicity using modern LLMs to keep your community safe.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 p-4">
                        <div class="icon-box"><i class="bi bi-speedometer2"></i></div>
                        <h4 data-i18n="features.speed_title">Blazing Fast Client</h4>
                        <p class="text-secondary" data-i18n="features.speed_desc">A lightweight Vanilla JS widget that never blocks your main thread, thanks to a Web Worker architecture and comment virtualization.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 p-4">
                        <div class="icon-box"><i class="bi bi-people-fill"></i></div>
                        <h4 data-i18n="features.community_title">Full Community System</h4>
                        <p class="text-secondary" data-i18n="features.community_desc">Users get rich profiles, follow/block capabilities, in-app notifications, and encrypted local session data for privacy.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 p-4">
                        <div class="icon-box"><i class="bi bi-mic-fill"></i></div>
                        <h4 data-i18n="features.rich_title">Rich Interactions</h4>
                        <p class="text-secondary" data-i18n="features.rich_desc">Go beyond text with audio recording & transcription, user @mentions, text quoting, emoji reactions, and integrated surveys.</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100 p-4">
                        <div class="icon-box"><i class="bi bi-shield-lock-fill"></i></div>
                        <h4 data-i18n="features.security_title">Secure & Private</h4>
                        <p class="text-secondary" data-i18n="features.security_desc">Built-in Captcha support (Turnstile/reCAPTCHA) and AES-GCM encryption for cached user profiles in the browser.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="architecture" class="py-5">
        <div class="container">
            <div class="text-center mb-5">
                <h2 data-i18n="architecture.title">Built for Performance & Scale</h2>
                <p class="lead text-secondary" data-i18n="architecture.subtitle">A modern, decoupled microservice architecture.</p>
            </div>
            <div class="row g-5 align-items-center">
                <div class="col-lg-6">
                    <h3 data-i18n="architecture.stack_title">The Quelora Stack</h3>
                    <p class="text-secondary" data-i18n="architecture.stack_desc">Quelora runs on a robust backend API (Node.js, Express) that handles logic, authentication, and AI tasks. It uses Redis for high-speed caching and real-time operations, and MongoDB for persistent, scalable data storage.</p>
                    <div class="d-flex flex-column gap-3">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-braces text-primary fs-4 me-3"></i>
                            <span data-i18n="architecture.feature1">**Client:** Vanilla JS, Web Workers, WebSocket</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-server text-primary fs-4 me-3"></i>
                            <span data-i18n="architecture.feature2">**API:** Node.js, Express, Puppeteer, Socket.io</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="bi bi-database-fill-check text-primary fs-4 me-3"></i>
                            <span data-i18n="architecture.feature3">**Databases:** Redis (Cache) & MongoDB (Storage)</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card p-3">
                        <div class="img-placeholder">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="contactModalOverlay" class="contact-modal-overlay hidden">
        <div class="contact-modal">
            
            <div id="contactFormWrapper">
                <button id="closeContactModal" class="contact-close-btn" aria-label="Close Modal">
                    <svg viewBox="0 0 24 24" width="18px" height="18px" fill="currentColor">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
                    </svg>
                </button>
                
                <h3 data-i18n="contact.title">Professional Contact</h3>
                <p data-i18n="contact.subtitle">Interested in collaborating? Send me a message.</p>
                
                <form id="contactForm" class="contact-form">
                    <div class="form-group">
                        <label for="contactName" data-i18n="contact.name">Full Name *</label>
                        <input type="text" id="contactName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="contactEmail" data-i18n="contact.email">Email *</label>
                        <input type="email" id="contactEmail" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="contactCompany" data-i18n="contact.company">Company (Optional)</label>
                        <input type="text" id="contactCompany" name="company">
                    </div>
                    <div class="form-group">
                        <label for="contactSubject" data-i18n="contact.subject">Subject *</label>
                        <input type="text" id="contactSubject" name="subject" required>
                    </div>
                    <div class="form-group">
                        <label for="contactMessage" data-i18n="contact.message">Message *</label>
                        <textarea id="contactMessage" name="message" rows="5" required></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" id="contactSubmitButton" class="primary-btn" data-i18n="contact.send">Send Message</button>
                    </div>
                </form>
                <div id="contactStatus" class="contact-status"></div>
            </div>

            <div id="contactSuccessView" class="contact-success-view hidden">
                <h3 data-i18n="contact.success_title">Message Sent!</h3>
                <p data-i18n="contact.success_desc">Thank you for getting in touch. I will get back to you shortly.</p>
                <button id="closeSuccessBtn" class="primary-btn" data-i18n="contact.close">Close</button>
            </div>

        </div>
    </div>

    <footer class="py-5" style="background-color: var(--color-background-dark) !important;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 mb-4 mb-md-0">
                    <a class="d-inline-flex align-items-center text-decoration-none" href="#" style="color: var(--color-text-dark);">
                        <img src="https://avatars.githubusercontent.com/u/224778839?v=4" alt="Quelora Logo" width="40" class="me-2 rounded-circle">
                        <span class="fs-5 fw-bold">Quelora</span>
                    </a>
                    <p class="mt-2 mb-0 text-secondary" data-i18n="footer.description">Open-source dynamic content and moderation platform for modern websites.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="btn-group btn-group-actions">
                        <a href="https://github.com/Quelora" class="btn btn-outline-secondary">
                            <i class="bi bi-github"></i> <span data-i18n="footer.github">GitHub</span>
                        </a>
                        <a href="https://github.com/Quelora/quelora-infra#readme" class="btn btn-outline-secondary">
                            <i class="bi bi-file-text"></i> <span data-i18n="footer.docs">Docs</span>
                        </a>
                        <a href="#" class="btn btn-outline-secondary" id="contactLink">
                            <i class="bi bi-chat"></i> <span data-i18n="footer.contact">Contact</span>
                        </a>
                    </div>
                </div>
            </div>
            <hr class="my-4" style="border-color: var(--color-border);">
            <div class="text-center text-secondary">
                <p class="mb-0" data-i18n="footer.copyright">© 2025 Quelora. Open-source under GPL v3 License.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const htmlElement = document.documentElement;
        
        const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        
        if (savedTheme === 'dark') {
            htmlElement.setAttribute('data-theme', 'dark');
            themeIcon.classList.remove('bi-sun-fill');
            themeIcon.classList.add('bi-moon-fill');
        } else {
            htmlElement.removeAttribute('data-theme');
            themeIcon.classList.remove('bi-moon-fill');
            themeIcon.classList.add('bi-sun-fill');
        }
        
        themeToggle.addEventListener('click', () => {
            if (htmlElement.getAttribute('data-theme') === 'dark') {
                htmlElement.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
                themeIcon.classList.remove('bi-moon-fill');
                themeIcon.classList.add('bi-sun-fill');
            } else {
                htmlElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                themeIcon.classList.remove('bi-sun-fill');
                themeIcon.classList.add('bi-moon-fill');
            }
        });
        
        const languageOptions = document.querySelectorAll('.language-option');
        const currentLanguageFlag = document.getElementById('currentLanguageFlag');
        const currentLanguageText = document.getElementById('currentLanguage');
        
        const newTranslations = {
            "page_title": {
                "en": "Quelora | High-Performance Comment System with Augmented Intelligence",
                "es": "Quelora | Sistema de Comentarios de Alto Rendimiento con Inteligencia Aumentada",
                "fr": "Quelora | Système de Commentaires Haute Performance avec Intelligence Augmentée",
                "de": "Quelora | Hochleistungs-Kommentarsystem mit Erweiterter Intelligenz"
            },
            "nav.demo": { "en": "Demo", "es": "Demo", "fr": "Démo", "de": "Demo" },
            "nav.features": { "en": "Features", "es": "Funcionalidades", "fr": "Fonctionnalités", "de": "Funktionen" },
            "nav.architecture": { "en": "Architecture", "es": "Arquitectura", "fr": "Architecture", "de": "Architektur" },
            "nav.get_started_short": { "en": "Deployment", "es": "Despliegue", "fr": "Déploiement", "de": "Bereitstellung" },
            "nav.docs": { "en": "Docs", "es": "Docs", "fr": "Docs", "de": "Doks" },
            "nav.view_infra": { "en": "View Infra", "es": "Ver Infra", "fr": "Voir l'Infra", "de": "Infra ansehen" },
            "hero.new_title": {
                "en": "Quelora. The High-Performance Comment System with Augmented Intelligence.",
                "es": "Quelora. El Sistema de Comentarios de Alto Rendimiento con Inteligencia Aumentada."
            },
            "hero.new_subtitle": {
                "en": "Advanced moderation, geolocation, and analytics powered by AI, natively integrated into your website.",
                "es": "Moderación avanzada, geolocalización y analíticas impulsadas por IA, integradas en su sitio web de forma nativa."
            },
            "hero.view_live_demo": { "en": "View Live Demo", "es": "Ver Demo en Vivo" },
            "hero.explore_api": { "en": "Explore API", "es": "Explorar API" },
            "demo.title": { "en": "See it in Action", "es": "Verlo en Acción" },
            "demo.subtitle": { "en": "From the multi-tenant control panel to the end-user widget.", "es": "Desde el panel de control multi-tenant hasta el widget del usuario final." },
            "demo.dashboard_title": { "en": "Centralized Dashboard", "es": "Dashboard Centralizado" },
            "demo.dashboard_text": { "en": "Manage sites, moderate content, view analytics, and configure AI settings from one place.", "es": "Gestiona sitios, modera contenido, ve analíticas y configura la IA desde un solo lugar." },
            "demo.widget_title": { "en": "Live Comment Widget", "es": "Widget de Comentarios en Vivo" },
            "demo.widget_text": { "en": "The fast, responsive, and feature-rich client that integrates into your site.", "es": "El cliente rápido, adaptable y rico en funciones que se integra en tu sitio." },
            "features.title": { "en": "A Complete Engagement Platform", "es": "Una Plataforma de Interacción Completa" },
            "features.subtitle": { "en": "More than just comments. A full suite of tools for your community.", "es": "Más que solo comentarios. Una suite completa de herramientas para tu comunidad." },
            "features.live_chat_title": { "en": "Real-time Live Chat", "es": "Chat en Vivo" },
            "features.live_chat_desc": { "en": "Engage your audience instantly with WebSocket-powered live chat, complete with typing indicators and viewer counts.", "es": "Interactúa al instante con tu audiencia mediante chat en vivo (WebSockets), con indicadores de escritura y conteo de espectadores." },
            "features.ai_title": { "en": "AI-Powered Moderation", "es": "Moderación con IA" },
            "features.ai_desc": { "en": "Automatically analyzes sentiment, summarizes debates, and filters toxicity using modern LLMs to keep your community safe.", "es": "Analiza sentimientos, resume debates y filtra toxicidad automáticamente usando LLMs modernos para mantener tu comunidad segura." },
            "features.speed_title": { "en": "Blazing Fast Client", "es": "Cliente Ultra-Rápido" },
            "features.speed_desc": { "en": "A lightweight Vanilla JS widget that never blocks your main thread, thanks to a Web Worker architecture and comment virtualization.", "es": "Un widget Vanilla JS ligero que nunca bloquea tu hilo principal, gracias a una arquitectura de Web Workers y virtualización de comentarios." },
            "features.community_title": { "en": "Full Community System", "es": "Sistema de Comunidad Completo" },
            "features.community_desc": { "en": "Users get rich profiles, follow/block capabilities, in-app notifications, and encrypted local session data for privacy.", "es": "Perfiles de usuario, capacidad de seguir/bloquear, notificaciones en-app y datos de sesión encriptados para mayor privacidad." },
            "features.rich_title": { "en": "Rich Interactions", "es": "Interacciones Enriquecidas" },
            "features.rich_desc": { "en": "Go beyond text with audio recording & transcription, user @mentions, text quoting, emoji reactions, and integrated surveys.", "es": "Más allá del texto: grabación de audio y transcripción, @menciones, citas de texto, emojis y encuestas integradas." },
            "features.security_title": { "en": "Secure & Private", "es": "Seguro y Privado" },
            "features.security_desc": { "en": "Built-in Captcha support (Turnstile/reCAPTCHA) and AES-GCM encryption for cached user profiles in the browser.", "es": "Soporte Captcha integrado (Turnstile/reCAPTCHA) y encriptación AES-GCM para los perfiles cacheados en el navegador." },
            "architecture.title": { "en": "Built for Performance & Scale", "es": "Construido para Rendimiento y Escala" },
            "architecture.subtitle": { "en": "A modern, decoupled microservice architecture.", "es": "Una arquitectura de microservicios moderna y desacoplada." },
            "architecture.stack_title": { "en": "The Quelora Stack", "es": "El Stack de Quelora" },
            "architecture.stack_desc": { "en": "Quelora runs on a robust backend API (Node.js, Express) that handles logic, authentication, and AI tasks. It uses Redis for high-speed caching and real-time operations, and MongoDB for persistent, scalable data storage.", "es": "Quelora corre sobre una API backend robusta (Node.js, Express) que maneja lógica, autenticación y tareas de IA. Usa Redis para caché de alta velocidad y MongoDB para almacenamiento persistente." },
            "architecture.feature1": { "en": "**Client:** Vanilla JS, Web Workers, WebSocket", "es": "**Cliente:** Vanilla JS, Web Workers, WebSocket" },
            "architecture.feature2": { "en": "**API:** Node.js, Express, Puppeteer, Socket.io", "es": "**API:** Node.js, Express, Puppeteer, Socket.io" },
            "architecture.feature3": { "en": "**Databases:** Redis (Cache) & MongoDB (Storage)", "es": "**Bases de datos:** Redis (Caché) & MongoDB (Almacenamiento)" },
            "get_started.title": { "en": "Deploy in Minutes", "es": "Despliegue en Minutos" },
            "get_started.subtitle": { "en": "Launch your self-hosted instance with our optimized Docker Compose.", "es": "Inicia tu instancia auto-alojada con nuestro Docker Compose optimizado." },
            "get_started.clone_title": { "en": "1. Clone Infrastructure and Components", "es": "1. Clona la Infraestructura y Componentes" },
            "get_started.clone_desc_new": { "en": "The Docker Compose infrastructure (`quelora-infra`) manages the orchestration of the API, Dashboard, Client, and databases (Redis/Mongo).", "es": "La infraestructura Docker Compose (`quelora-infra`) gestiona la orquestación de la API, Dashboard, Cliente y las bases de datos (Redis/Mongo)." },
            "get_started.build_title": { "en": "2. Configuration and Final Deployment", "es": "2. Configuración y Despliegue Final" },
            "get_started.build_desc_new": { "en": "Define environment variables for databases and services, then build and launch the complete microservices stack.", "es": "Define las variables de entorno para las bases de datos y servicios, luego construye y lanza la pila completa de microservicios." },
            "get_started.full_docs": { "en": "Full Documentation (Infra)", "es": "Documentación Completa (Infra)" },
            "footer.description": { "en": "Open-source dynamic content and moderation platform for modern websites.", "es": "Plataforma de contenido dinámico y moderación de código abierto para sitios web modernos." },
            "footer.github": { "en": "GitHub", "es": "GitHub" },
            "footer.docs": { "en": "Docs", "es": "Docs" },
            "footer.contact": { "en": "Contact", "es": "Contacto" },
            "footer.copyright": { "en": "© 2025 Quelora. Open-source under GPL v3 License.", "es": "© 2025 Quelora. Código abierto bajo licencia GPL v3." },
            
            "contact.title": { "en": "Professional Contact", "es": "Contacto Profesional" },
            "contact.subtitle": { "en": "Interested in collaborating? Send me a message.", "es": "¿Interesado en colaborar? Envíame un mensaje." },
            "contact.name": { "en": "Full Name *", "es": "Nombre Completo *" },
            "contact.email": { "en": "Email *", "es": "Email *" },
            "contact.company": { "en": "Company (Optional)", "es": "Empresa (Opcional)" },
            "contact.subject": { "en": "Subject *", "es": "Asunto *" },
            "contact.message": { "en": "Message *", "es": "Mensaje *" },
            "contact.send": { "en": "Send Message", "es": "Enviar Mensaje" },
            "contact.sending": { "en": "Sending...", "es": "Enviando..." },
            "contact.success_title": { "en": "Message Sent!", "es": "¡Mensaje Enviado!" },
            "contact.success_desc": { "en": "Thank you for getting in touch. I will get back to you shortly.", "es": "Gracias por contactarte. Te responderé a la brevedad." },
            "contact.close": { "en": "Close", "es": "Cerrar" }
        };

        function applyTranslations(lang) {
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                let translation = newTranslations[key] && newTranslations[key][lang] ? newTranslations[key][lang] : i18next.t(key);
                
                element.innerHTML = ''; 

                if (translation.includes('**')) {
                    const parts = translation.split('**');
                    parts.forEach((part, index) => {
                        if (index % 2 === 1) {
                            const strong = document.createElement('strong');
                            strong.textContent = part;
                            element.appendChild(strong);
                        } else {
                            element.appendChild(document.createTextNode(part));
                        }
                    });
                } else {
                    element.textContent = translation;
                }
            });
            if(newTranslations['page_title'] && newTranslations['page_title'][lang]) {
                document.title = newTranslations['page_title'][lang];
            }
        }
        
        languageOptions.forEach(option => {
            option.addEventListener('click', (e) => {
                e.preventDefault();
                const lang = option.getAttribute('data-lang');
                i18next.changeLanguage(lang, (err) => {
                    localStorage.setItem('language', lang);
                    applyTranslations(lang);
                    updateLanguageDisplay(lang);
                });
            });
        });

        function updateLanguageDisplay(lang) {
            let flagUrl, languageText;
            switch(lang) {
                case 'es':
                    flagUrl = 'https://flagcdn.com/w20/es.png'; languageText = 'ES'; break;
                case 'fr':
                    flagUrl = 'https://flagcdn.com/w20/fr.png'; languageText = 'FR'; break;
                case 'de':
                    flagUrl = 'https://flagcdn.com/w20/de.png'; languageText = 'DE'; break;
                default:
                    flagUrl = 'https://flagcdn.com/w20/us.png'; languageText = 'EN';
            }
            currentLanguageFlag.src = flagUrl;
            currentLanguageFlag.alt = languageText;
            currentLanguageText.textContent = languageText;
        }

        i18next.init({
            lng: localStorage.getItem('language') || 'en',
            debug: false,
            resources: {}
        }, function(err, t) {
            const currentLang = i18next.language;
            applyTranslations(currentLang);
            updateLanguageDisplay(currentLang);
            
            i18next.on('languageChanged', (lng) => {
                applyTranslations(lng);
                updateLanguageDisplay(lng);
            });
        });

        const contactLink = document.getElementById('contactLink');
        const navContactLink = document.getElementById('navContactLink');
        const heroContactLink = document.getElementById('heroContactLink');
        const contactModalOverlay = document.getElementById('contactModalOverlay');
        const closeContactModalBtn = document.getElementById('closeContactModal');
        const contactForm = document.getElementById('contactForm');
        const contactStatus = document.getElementById('contactStatus');
        const contactSubmitButton = document.getElementById('contactSubmitButton');
        const contactFormWrapper = document.getElementById('contactFormWrapper');
        const contactSuccessView = document.getElementById('contactSuccessView');
        const closeSuccessBtn = document.getElementById('closeSuccessBtn');

        function openContactModal() {
            if (contactModalOverlay) {
                contactModalOverlay.classList.remove('hidden');
            }
        }

        function closeContactModal() {
            if (contactModalOverlay) {
                contactModalOverlay.classList.add('hidden');
                
                if (contactFormWrapper) contactFormWrapper.classList.remove('hidden');
                if (contactSuccessView) contactSuccessView.classList.add('hidden');
                
                if (contactForm) contactForm.reset();
                if (contactStatus) contactStatus.textContent = '';
                if (contactStatus) contactStatus.className = 'contact-status';
                if (contactSubmitButton) contactSubmitButton.disabled = false;
                
                const sendText = (window.i18next && i18next.t('contact.send')) || "Send Message";
                if (contactSubmitButton) contactSubmitButton.textContent = sendText;
            }
        }

        async function handleContactSubmit(event) {
            event.preventDefault();
            if (!contactForm) return;

            contactSubmitButton.disabled = true;
            const sendingText = (window.i18next && i18next.t('contact.sending')) || "Sending...";
            contactSubmitButton.textContent = sendingText;
            contactStatus.textContent = '';
            contactStatus.className = 'contact-status';

            const formData = new FormData(contactForm);
            const data = {
                name: formData.get('name'),
                email: formData.get('email'),
                company: formData.get('company'),
                subject: formData.get('subject'),
                message: formData.get('message'),
            };

            try {
                const response = await fetch('/api/contact', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                });

                const result = await response.json();

                if (response.ok) {
                    contactForm.reset();
                    if (contactFormWrapper) contactFormWrapper.classList.add('hidden');
                    if (contactSuccessView) contactSuccessView.classList.remove('hidden');
                } else {
                    throw new Error(result.error || 'Unknown error.');
                }

            } catch (error) {
                contactStatus.textContent = `Error: ${error.message}`;
                contactStatus.className = 'contact-status error';
                contactSubmitButton.disabled = false;
                const sendText = (window.i18next && i18next.t('contact.send')) || "Send Message";
                contactSubmitButton.textContent = sendText;
            }
        }

        const setupContactTrigger = (button) => {
            if (button) {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    openContactModal();
                });
            }
        };

        setupContactTrigger(contactLink);
        setupContactTrigger(navContactLink);
        setupContactTrigger(heroContactLink);

        if (closeContactModalBtn) {
            closeContactModalBtn.addEventListener('click', closeContactModal);
        }

        if (contactModalOverlay) {
            contactModalOverlay.addEventListener('click', (e) => {
                if (e.target === contactModalOverlay) {
                    closeContactModal();
                }
            });
        }

        if (contactForm) {
            contactForm.addEventListener('submit', handleContactSubmit);
        }

        if (closeSuccessBtn) {
            closeSuccessBtn.addEventListener('click', closeContactModal);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (contactModalOverlay && !contactModalOverlay.classList.contains('hidden')) {
                    closeContactModal();
                }
            }
        });
    </script>
</body>
</html>